# webapp-custom-db
Программа для просмотра базы данных электронных компонентов.


# О программе
Программа написана на Python 3.10.8 с использованием фреймворка Flask. База данных реазилована при помощи SQLite.

Пользовательский интерфейс представляет из себя веб-приложение, написанное на HTML, CSS и JavaScript с применением библиотеки jQuery.

Интерфейс базы данных позволяет сортировать компоненты в алфавитном порядке, по каждому столбцу. Также имеются инструменты фильтрации поиском и попаданием значения в выбранный диапазон.


# Системные требования
 - ОС: Windows 7 x64 (с последними обновлениями) и выше.
 - Веб-браузер на основе Chromium, любой версии выпушенной не раньше 2017-го года. (Chrome, Opera, Yandex, Brave)
 - Подключение к интернету не обязательно.


# Перед запуском программы
Для работы программы нужно поместить её исполняемый файл в отдельную папку, содержащую папку с названием "databases". Внутри папки "databases" должен быть файл базы данных "db1.db" и папка с названием "db1". 

Внутри папки "db1" должны быть .pdf документы - даташиты компонентов. Каждый документ должен быть назван так же, как и назван компонент, который он представляет. В название не должно содержать спецсимволов, все они должны быть заменены на нижнее подчёркивание "_". 

Например: 

Название компонента - "A123,/!B(C)"; 

Полное имя .pdf документа - "A123___B_C_.pdf".


# Запуск программы
Для запуска программы необходимо запустить "main". 

Если база найдена в корне программы, и поддерживаемый браузер установлен в системе "по-умолчанию", то он будет открыт, где пользователя встретит интерфейс базы данных.


# Конвертация
Необходима SQLite база данных в соответствующем формате вместе с папкой содержащей .pdf даташиты компонентов.

Изначально база данных представлена в табличном формате Книга Excel (*.xlsx). 

После того, как соответствующая таблица заполнена, можно переходить к конвертации базы в формат, понимаемый программой:
1. Необходимо запустить "convert_excel". Будет открыто меню выбора файла.
2. Выбираем там нашу таблицу с расширением ".xlsx", нажимаем "Открыть".
3. Если всё выполнено успешно, программа для конвертации выведет финальное сообщение "Готово", а потом закроется.
4. В той же папке, где была наша изначальная таблица, появится файл с таким же названием, но уже с расширением ".db". Для его работы в программе для просмотра надо переименовать его в "db1" и переместить в папку "databases" в корне программы.


# Формат таблицы Excel
Пример формата представлен в файле "db1.xlsx"

Первая строка первого столбца всегда должна содержать название базы данных.

Со второго столбца начинается таблица компонентов:

- Первая строка - это ID (Айди) столбца. Для столбца, содержащего название компонента, которое будет использоваться для поиска .pdf документа, должно быть выставлено значение "name". Для остальных столбцов значение может быть любое, но уникальное для каждого столбца.

- Вторая строка - Название столбца. 
Будет отображаться в пользовательском интерфейсе.

- Третья строка - Единица измерения. Если выставлено значение "Hz", то в пользовательском интерфейсе будет автоматический перевод в kHz, MHz, GHz. В остальных случаях никакого эффекта не имеет. Будет отображаться в пользовательском интерфейсе.

- Четвертая строка - Тип данных в ячейках. Необходимо для правильной конвертации, и выбора типа поиска. 

Типа данных всего пять:
1. "str" - Текст. Используется для наименований компонентов, производителей. Если выставленно, фильтрация по столбцу будет выполнена при помощи поиска.
2. "int" - Целое число. Если выставленно, фильтрация по столбцу будет выполнена при помощи попадания в диапазон "от-до".
3. "int~" - То же, что "int", но для значений диапазона. Например, диапазон рабочих частот.
4. "float" - Дробное число. Если выставленно, фильтрация по столбцу будет выполнена при помощи попадания в диапазон "от-до".
5. "float~" - То же, что "float", но для значений диапазона. Например, напряжение питания мин-макс.


Диапазоны вписываются в ячейки через нижнее подчёркивание.

Например:

Диапазон в даташите: "1 Hz - 3 kHz"

Значение в ячейке: "1_3000"; Тип данных "int~"

Диапазон в даташите: "1.5 В - 5 В"

Значение в ячейке: "1.5_5"; Тип данных "float~"

Пустых ячеек в значениях диапазонов быть не может!

ВНИМАНИЕ: Любое несоблюдение данного формата может привести к ошибкам в конвертации и повреждению конвертированной базы! 
Повреждённая база работать НЕ БУДЕТ!


# Запуск и сборка

Для запуска файлов .py необходимо установить Python 3.10.8 и выше, и установить зависимости, при помощи коммандной строки: "pip install -r requirements.txt"

Исполняемый файл .exe можно получить при помоши pyinstaller, установив его: "pip install pyinstaller", далее запустив команды: 

```
pyinstaller main.spec
pyinstaller convert_excel.spec
```


# Возможные проблемы

- База работает, но даташит не открывается.

    Скорее всего, произошла проблема с заменой спецсимволов в названии элемента, или оно просто не совпадает с названием .pdf документа. Проверьте форматирование.

- "convert_excel" - не выводит сообщение "Готово".

    Проверьте форматирование таблицы. Любые отклонения могут привести к ошибке. Например, у Вас может стоять тип данных "int", а в таблице быть дробные значения.

- "main" закрывается при открытии.

    Произошла ошибка при попытке открытии базы данных или её чтении. Проверьте, все ли файлы на своих местах, и есть ли к ним доступ.

- Windows 7. Ошибка с файлом "api-ms-win-core-path-l1-1-0.dll".

    При сборке программы не был подключен данный файл. В архиве с этим документом он имеется, необходимо либо пересобрать программу вместе с ним, либо положить его в папку "C:\Windows\System32".